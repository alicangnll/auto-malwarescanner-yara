import os
os.system("apt-get install libsnappy-dev && pip3 install -r volatility/requirements.txt")

def malwarescan(filename, plugin, yarafile):
    if plugin == "":
        command = "python3 volatility/vol.py -f " + str(filename) + " yarascan.YaraScan --yara-file yarakural/" + str(yarafile)
    else:
        command = "python3 volatility/vol.py -f " + str(filename) + " " + str(plugin) + " --yara-file yarakural/" + str(yarafile)

    os.system(command)

print("===========================================================\n")
print(" AUTOMATICALLY RULE BASED MALWARE SCANNER (DEVELOPED BY ALICAN)\n")
print("===========================================================\n")
ramdumpfile = input("RAM Dump dosyanizin adı : ")
print("banners.Banners, \nconfigwriter.ConfigWriter, \nframeworkinfo.FrameworkInfo, \nisfinfo.IsfInfo, \nlayerwriter.LayerWriter, \nlinux.bash.Bash, \nlinux.check_afinfo.Check_afinfo, \nlinux.check_creds.Check_creds, \nlinux.check_idt.Check_idt, \nlinux.check_modules.Check_modules, \nlinux.check_syscall.Check_syscall, \nlinux.elfs.Elfs, \nlinux.keyboard_notifiers.Keyboard_notifiers, \nlinux.kmsg.Kmsg, \nlinux.lsmod.Lsmod, \nlinux.lsof.Lsof, \nlinux.malfind.Malfind, \nlinux.mountinfo.MountInfo, \nlinux.proc.Maps, \nlinux.psaux.PsAux, \nlinux.pslist.PsList, \nlinux.pstree.PsTree, \nlinux.tty_check.tty_check, \nmac.bash.Bash, \nmac.check_syscall.Check_syscall, \nmac.check_sysctl.Check_sysctl, \nmac.check_trap_table.Check_trap_table, \nmac.ifconfig.Ifconfig, \nmac.kauth_listeners.Kauth_listeners, \nmac.kauth_scopes.Kauth_scopes, \nmac.kevents.Kevents, \nmac.list_files.List_Files, \nmac.lsmod.Lsmod, \nmac.lsof.Lsof, \nmac.malfind.Malfind, \nmac.mount.Mount, \nmac.netstat.Netstat, \nmac.proc_maps.Maps, \nmac.psaux.Psaux, \nmac.pslist.PsList, \nmac.pstree.PsTree, \nmac.socket_filters.Socket_filters, \nmac.timers.Timers, \nmac.trustedbsd.Trustedbsd, \nmac.vfsevents.VFSevents, \ntimeliner.Timeliner, \nwindows.bigpools.BigPools, \nwindows.cachedump.Cachedump, \nwindows.callbacks.Callbacks, \nwindows.cmdline.CmdLine, \nwindows.crashinfo.Crashinfo, \nwindows.devicetree.DeviceTree, \nwindows.dlllist.DllList, \nwindows.driverirp.DriverIrp, \nwindows.driverscan.DriverScan, \nwindows.dumpfiles.DumpFiles, \nwindows.envars.Envars, \nwindows.filescan.FileScan, \nwindows.getservicesids.GetServiceSIDs, \nwindows.getsids.GetSIDs, \nwindows.handles.Handles, \nwindows.hashdump.Hashdump, \nwindows.info.Info, \nwindows.ldrmodules.LdrModules, \nwindows.lsadump.Lsadump, \nwindows.malfind.Malfind, \nwindows.mbrscan.MBRScan, \nwindows.memmap.Memmap, \nwindows.mftscan.MFTScan, \nwindows.modscan.ModScan, \nwindows.modules.Modules, \nwindows.mutantscan.MutantScan, \nwindows.netscan.NetScan, \nwindows.netstat.NetStat, \nwindows.poolscanner.PoolScanner, \nwindows.privileges.Privs, \nwindows.pslist.PsList, \nwindows.psscan.PsScan, \nwindows.pstree.PsTree, \nwindows.registry.certificates.Certificates, \nwindows.registry.hivelist.HiveList, \nwindows.registry.hivescan.HiveScan, \nwindows.registry.printkey.PrintKey, \nwindows.registry.userassist.UserAssist, \nwindows.sessions.Sessions, \nwindows.skeleton_key_check.Skeleton_Key_Check, \nwindows.ssdt.SSDT, \nwindows.statistics.Statistics, \nwindows.strings.Strings, \nwindows.svcscan.SvcScan, \nwindows.symlinkscan.SymlinkScan, \nwindows.vadinfo.VadInfo, \nwindows.vadyarascan.VadYaraScan, \nwindows.verinfo.VerInfo, \nwindows.virtmap.VirtMap, \nyarascan.YaraScan\n")
plugin = input("Kullanmak istediğiniz eklentiler : ")

yaralist = os.listdir("yarakural")
for val in yaralist:
    malwarescan(ramdumpfile, plugin, val)