import os
os.system("apt-get install libsnappy-dev && pip3 install -r volatility/requirements.txt")

def malwarescan(filename, profile, yarafile):
    command = "python3 volatility/vol.py -f " + str(filename) + " --profile=" + str(profile) + " yarascan -Y " + str(yarafile) + ""
    yara = os.system(command)
    print(command)

print("===========================================================\n")
print(" AUTOMATICALLY RULE BASED MALWARE SCANNER (DEVELOPED BY ALICAN)\n")
print("===========================================================\n")
ramdumpfile = input("RAM Dump dosyanizin adı : ")
print("===========================================================\n")
print("Win10x64              - A Profile for Windows 10 x64\n")
print("Win10x64_10240_17770  - A Profile for Windows 10 x64 (10.0.10240.17770 / 2018-02-10)\n")
print("Win10x64_10586        - A Profile for Windows 10 x64 (10.0.10586.306 / 2016-04-23)\n")
print("Win10x64_14393        - A Profile for Windows 10 x64 (10.0.14393.0 / 2016-07-16)\n")
print("Win10x64_15063        - A Profile for Windows 10 x64 (10.0.15063.0 / 2017-04-04)\n")
print("Win10x64_16299        - A Profile for Windows 10 x64 (10.0.16299.0 / 2017-09-22)\n")
print("Win10x64_17134        - A Profile for Windows 10 x64 (10.0.17134.1 / 2018-04-11)\n")
print("Win10x64_17763        - A Profile for Windows 10 x64 (10.0.17763.0 / 2018-10-12)\n")
print("Win10x64_18362        - A Profile for Windows 10 x64 (10.0.18362.0 / 2019-04-23)\n")
print("Win10x64_19041        - A Profile for Windows 10 x64 (10.0.19041.0 / 2020-04-17)\n")
print("Win10x86              - A Profile for Windows 10 x86\n")
print("Win10x86_10240_17770  - A Profile for Windows 10 x86 (10.0.10240.17770 / 2018-02-10)\n")
print("Win10x86_10586        - A Profile for Windows 10 x86 (10.0.10586.420 / 2016-05-28)\n")
print("Win10x86_14393        - A Profile for Windows 10 x86 (10.0.14393.0 / 2016-07-16)\n")
print("Win10x86_15063        - A Profile for Windows 10 x86 (10.0.15063.0 / 2017-04-04)\n")
print("Win10x86_16299        - A Profile for Windows 10 x86 (10.0.16299.15 / 2017-09-29)\n")
print("Win10x86_17134        - A Profile for Windows 10 x86 (10.0.17134.1 / 2018-04-11)\n")
print("Win10x86_17763        - A Profile for Windows 10 x86 (10.0.17763.0 / 2018-10-12)\n")
print("Win10x86_18362        - A Profile for Windows 10 x86 (10.0.18362.0 / 2019-04-23)\n")
print("Win10x86_19041        - A Profile for Windows 10 x86 (10.0.19041.0 / 2020-04-17)\n")
print("2008 R2 SP1 x64	Win2008R2SP1x64_23418\n")
print("2008 R2 x64		Win2012R2x64_18340\n")
print("7 SP1 x64		Win7SP1x64_23418\n")
print("7 SP1 x86		Win7SP1x86_23418\n")
print("7 SP1 x64		Win7SP1x64_24000\n")
print("7 SP1 x86		Win7SP1x86_24000\n")
print("8 x64		    Win8SP1x64_18340\n")
print("===========================================================\n")
ramdumpprofile = input("RAM Dump Dosyanizin İsletim Sistemi Profili : ")

yaralist = os.listdir("yarakural")
for val in yaralist:
    malwarescan(ramdumpfile, ramdumpprofile, val)